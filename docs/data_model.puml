@startuml

!include styles.puml

object owaStateStore {  
  bool soundReady
  Enum SESSION_PHASES sessionPhase
  \n
  LevelState levels[]
  SequencerState sequencers{}
}

object SESSION_PHASES { 
IDLE
TRANS_10
PLAYING_10
TRANS_8
PLAYING_8
TRANS_6
PLAYING_6
TRANS_4
PLAYING_4
ADVICE_READY
TRANS_ADVICE
PLAYING_ADVICE
TRANS_IDLE
}

owaStateStore *-- SESSION_PHASES

object LevelState {
  string levelId
  string sequencerIds[]
  \n
  Amount of sequencers (and buttons) on this level
  int numSegments
  \n
  Index of the active sequencer on this level or false if the level is 
  inactive.
  int activeSequencerIndex
  Id of the active sequencer.  This also needs to be stored because the
  playback order may change and the index above may no longer point to the
  currently playing sequencer
  string activeSequencerId
  \n
  Sequencer ordering (activeSequencerIndex is an index into this list).
  string sequencerPlaybackOrder[];
  \n
  If this level is currently in playback.
  PLAYING_STATES playingState
}
owaStateStore *-- LevelState

object linkStateStore {
  abletonlink.tempo
  abletonlink.beat
  abletonlink.bar
}

object SequencerState {
  Awakening sequencers object
  
  name
  clockOffsetSeconds
  beat
  nextBeat
  numBeats
  playingState
  isReady
  playQuant: [4, 0]
  stopQuant: [8, 0]
}
LevelState *-- SequencerState


@enduml
