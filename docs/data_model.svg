<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1156px" preserveAspectRatio="none" style="width:1533px;height:1156px;background:#1D1F21;" version="1.1" viewBox="0 0 1533 1156" width="1533px" zoomAndPan="magnify"><defs><filter height="300%" id="f3u019st7f8m3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="396.0469" style="stroke: #F0C674; stroke-width: 1.5;" width="332" x="877" y="8"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="50" x="1018" y="27.3359">state</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="878" x2="1208" y1="33.3359" y2="33.3359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="150" x="883" y="54.6719">bool soundReady</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="160" x="883" y="76.0078">bool lightsReady</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="50" x="883" y="97.3438">tempo</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="190" x="883" y="118.6797">fadecandyConnection</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="320" x="883" y="140.0156">Enum SESSION_PHASES sessionPhase</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="210" x="883" y="161.3516">sessionPhaseDurations</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="260" x="883" y="182.6875">inactivityTimeoutStartTime</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="893" y="204.0234"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="893" y="225.3594"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="150" x="883" y="246.6953">levels levels{}</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="190" x="883" y="268.0313">segments segments{}</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="270" x="883" y="289.3672">SequencerState sequencers{}</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="280" x="883" y="310.7031">IdlePlayerState idlePlayer{}</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="160" x="883" y="332.0391">bool level4Ready</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="160" x="883" y="353.375">bool level2Ready</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="160" x="883" y="374.7109">bool revealReady</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="240" x="883" y="396.0469">bool firstSegmentPressed</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="76.0078" style="stroke: #F0C674; stroke-width: 1.5;" width="182" x="390" y="549.5"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="60" x="451" y="568.8359">levels</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="391" x2="571" y1="574.8359" y2="574.8359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="170" x="396" y="596.1719">LevelState byId{}</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="150" x="396" y="617.5078">string allIds[]</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="374.7109" style="stroke: #F0C674; stroke-width: 1.5;" width="752" x="6" y="771"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="100" x="332" y="790.3359">LevelState</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="7" x2="757" y1="796.3359" y2="796.3359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="140" x="12" y="817.6719">string levelId</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="22" y="839.0078"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="22" y="860.3438"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="670" x="12" y="881.6797">Segment ordering (segmentPlaybackIndex is an index into this list).</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="300" x="12" y="903.0156">string segmentPlaybackOrder[];</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="22" y="924.3516"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="22" y="945.6875"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="660" x="12" y="967.0234">Index of the active segment on this level or false if the level is</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="90" x="12" y="988.3594">inactive.</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="220" x="12" y="1009.6953">int activeSegmentIndex</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="22" y="1031.0313"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="22" y="1052.3672"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="690" x="12" y="1073.7031">Id of the active sequencer.  This also needs to be stored because the</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="740" x="12" y="1095.0391">playback order may change and the segmentPlaybackIndex may no longer point</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="340" x="12" y="1116.375">to the currently playing sequencer</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="220" x="12" y="1137.7109">string activeSegmentId</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="76.0078" style="stroke: #F0C674; stroke-width: 1.5;" width="202" x="804" y="549.5"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="80" x="865" y="568.8359">segments</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="805" x2="1005" y1="574.8359" y2="574.8359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="190" x="810" y="596.1719">SegmentState byId{}</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="150" x="810" y="617.5078">string allIds[]</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="161.3516" style="stroke: #F0C674; stroke-width: 1.5;" width="422" x="793" y="878"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="120" x="944" y="897.3359">SegmentState</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="794" x2="1214" y1="903.3359" y2="903.3359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="160" x="799" y="924.6719">string segmentId</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="180" x="799" y="946.0078">string sequencerId</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="809" y="967.3438"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="0" x="809" y="988.6797"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="410" x="799" y="1010.0156">If this segment is currently in playback.</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="270" x="799" y="1031.3516">PLAYING_STATES playingState</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="310.7031" style="stroke: #F0C674; stroke-width: 1.5;" width="154" x="1244" y="50.5"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="140" x="1251" y="69.8359">SESSION_PHASES</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="1245" x2="1397" y1="75.8359" y2="75.8359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="40" x="1250" y="97.1719">IDLE</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="80" x="1250" y="118.5078">TRANS_10</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="100" x="1250" y="139.8438">PLAYING_10</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="70" x="1250" y="161.1797">TRANS_8</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="90" x="1250" y="182.5156">PLAYING_8</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="70" x="1250" y="203.8516">TRANS_6</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="90" x="1250" y="225.1875">PLAYING_6</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="70" x="1250" y="246.5234">TRANS_4</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="90" x="1250" y="267.8594">PLAYING_4</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="120" x="1250" y="289.1953">ADVICE_READY</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="120" x="1250" y="310.5313">TRANS_ADVICE</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="140" x="1250" y="331.8672">PLAYING_ADVICE</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="100" x="1250" y="353.2031">TRANS_IDLE</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="246.6953" style="stroke: #F0C674; stroke-width: 1.5;" width="282" x="1041" y="464"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="140" x="1112" y="483.3359">SequencerState</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="1042" x2="1322" y1="489.3359" y2="489.3359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="270" x="1047" y="510.6719">Awakening sequencers object</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="40" x="1047" y="532.0078">name</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="180" x="1047" y="553.3438">clockOffsetSeconds</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="40" x="1047" y="574.6797">beat</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="80" x="1047" y="596.0156">nextBeat</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="80" x="1047" y="617.3516">numBeats</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="120" x="1047" y="638.6875">playingState</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="70" x="1047" y="660.0234">isReady</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="90" x="1047" y="681.3594">playQuant</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="90" x="1047" y="702.6953">stopQuant</text><rect fill="#1D1F21" filter="url(#f3u019st7f8m3)" height="97.3438" style="stroke: #F0C674; stroke-width: 1.5;" width="164" x="1358" y="539"/><text fill="#F0C674" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="150" x="1365" y="558.3359">IdlePlayerState</text><line style="stroke: #F0C674; stroke-width: 1.5;" x1="1359" x2="1521" y1="564.3359" y2="564.3359"/><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="80" x="1364" y="585.6719">bufName,</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="130" x="1364" y="607.0078">playingState,</text><text fill="#C5C8C6" font-family="Monaco" font-size="16" lengthAdjust="spacingAndGlyphs" textLength="40" x="1364" y="628.3438">gate</text><!--link state to levels--><path d="M865.7875,326.2964 C752.5363,403.1742 613.1162,497.8162 537.05,549.4518 " fill="none" id="state-levels" style="stroke: #C5C8C6; stroke-width: 1.0;"/><polygon fill="#C5C8C6" points="876.6626,318.9141,869.4518,318.9745,866.7341,325.6539,873.9449,325.5935,876.6626,318.9141" style="stroke: #C5C8C6; stroke-width: 1.0;"/><!--link levels to LevelState--><path d="M467.3933,638.4909 C458.0726,673.4198 445.0797,722.1105 432.037,770.9875 " fill="none" id="levels-LevelState" style="stroke: #C5C8C6; stroke-width: 1.0;"/><polygon fill="#C5C8C6" points="470.7781,625.8062,465.3663,630.572,467.6841,637.4005,473.0958,632.6347,470.7781,625.8062" style="stroke: #C5C8C6; stroke-width: 1.0;"/><!--link state to segments--><path d="M966.9088,416.3536 C948.3923,467.5424 930.5642,516.828 918.8344,549.2548 " fill="none" id="state-segments" style="stroke: #C5C8C6; stroke-width: 1.0;"/><polygon fill="#C5C8C6" points="971.3726,404.0133,965.5702,408.2949,967.2907,415.2977,973.0931,411.0161,971.3726,404.0133" style="stroke: #C5C8C6; stroke-width: 1.0;"/><!--link segments to SegmentState--><path d="M918.6595,638.6884 C935.1513,700.4913 963.0848,805.1714 982.4818,877.861 " fill="none" id="segments-SegmentState" style="stroke: #C5C8C6; stroke-width: 1.0;"/><polygon fill="#C5C8C6" points="915.2219,625.8062,912.9042,632.6347,918.3159,637.4005,920.6337,630.572,915.2219,625.8062" style="stroke: #C5C8C6; stroke-width: 1.0;"/><!--link state to SequencerState--><path d="M1119.6704,416.4298 C1125.5723,432.6282 1131.4045,448.6352 1136.9942,463.977 " fill="none" id="state-SequencerState" style="stroke: #C5C8C6; stroke-width: 1.0;"/><polygon fill="#C5C8C6" points="1115.1464,404.0133,1113.4422,411.0201,1119.2545,415.2882,1120.9588,408.2814,1115.1464,404.0133" style="stroke: #C5C8C6; stroke-width: 1.0;"/><!--link state to IdlePlayerState--><path d="M1219.4696,398.1194 C1221.974,400.1136 1224.4846,402.0749 1227,404 C1272.4674,438.7986 1296.8335,427.5646 1341,464 C1366.8609,485.3341 1390.5572,514.3824 1408.2787,538.9472 " fill="none" id="state-IdlePlayerState" style="stroke: #C5C8C6; stroke-width: 1.0;"/><polygon fill="#C5C8C6" points="1209.2125,389.7442,1211.3301,396.6374,1218.5075,397.3339,1216.3899,390.4407,1209.2125,389.7442" style="stroke: #C5C8C6; stroke-width: 1.0;"/><!--
@startuml

skinparam backgroundColor #1d1f21
skinparam defaultFontName Monaco
skinparam defaultFontColor #c5c8c6
skinparam defaultFontSize 16
hide circle
skinparam class {
  backgroundColor #1d1f21
  fontColor #b294bb
  borderColor #b294bb
  arrowColor #c5c8c6
}
skinparam object {
  backgroundColor #1d1f21
  fontColor #f0c674
  borderColor #f0c674
  arrowColor #c5c8c6
}
skinparam state {
  backgroundColor #1d1f21
  borderColor #c5c8c6
  arrowColor #c5c8c6
}
skinparam sequenceParticipant {
  backgroundColor #1d1f21
  borderColor #c5c8c6
}
skinparam sequenceLifeLine {
  borderColor #c5c8c6
}
skinparam sequence {
  arrowColor #c5c8c6
}
skinparam component {
  backgroundColor #1d1f21
  borderColor #c5c8c6
}
skinparam interface {
  backgroundColor #1d1f21
  borderColor #c5c8c6
}
skinparam component {
  backgroundColor #1d1f21
  borderColor #c5c8c6
}

object state {  
  bool soundReady
  bool lightsReady
  tempo
  fadecandyConnection
  Enum SESSION_PHASES sessionPhase
  sessionPhaseDurations
  inactivityTimeoutStartTime
  \n
  levels levels{}
  segments segments{}
  SequencerState sequencers{}
  IdlePlayerState idlePlayer{}
  bool level4Ready
  bool level2Ready
  bool revealReady
  bool firstSegmentPressed
}

object levels {
  LevelState byId{}
  string allIds[]
}
state *- - levels
levels *- - LevelState

object segments {
  SegmentState byId{}
  string allIds[]
}
state *- - segments
segments *- - SegmentState

object SESSION_PHASES { 
IDLE
TRANS_10
PLAYING_10
TRANS_8
PLAYING_8
TRANS_6
PLAYING_6
TRANS_4
PLAYING_4
ADVICE_READY
TRANS_ADVICE
PLAYING_ADVICE
TRANS_IDLE
}

object SegmentState {
  string segmentId
  string sequencerId
  \n
  If this segment is currently in playback.
  PLAYING_STATES playingState
}

object LevelState {
  string levelId
  \n
  Segment ordering (segmentPlaybackIndex is an index into this list).
  string segmentPlaybackOrder[];
  \n
  Index of the active segment on this level or false if the level is 
  inactive.
  int activeSegmentIndex
  \n
  Id of the active sequencer.  This also needs to be stored because the
  playback order may change and the segmentPlaybackIndex may no longer point
  to the currently playing sequencer
  string activeSegmentId
}

object SequencerState {
  Awakening sequencers object
  
  name
  clockOffsetSeconds
  beat
  nextBeat
  numBeats
  playingState
  isReady
  playQuant
  stopQuant
}
state *- - SequencerState

object IdlePlayerState {
  bufName,
  playingState,
  gate
}
state *- - IdlePlayerState


@enduml

PlantUML version 1.2018.14(Fri Dec 21 08:33:16 PST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.2+9-LTS
Operating System: Mac OS X
OS Version: 10.14
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>